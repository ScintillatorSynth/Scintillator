# encrypted key password for symbol_upload_key_password
env:
  global:
    secure: w/xMGQ+3OSfEiBqnPE2CrC6LcsIiLMwOHhwUgnygDzoI1QgirQ66Lb1nQz6U0GGp6bCHiKoXfzhsVxNuieFOzLO/7ZrV8Gei+NFPWb3s8auu+hH3+eBdiagrED+yxZuafY2hPuJVihQ7cZS06tNpvCFuzKVDfbVzeoLdWRX1WJMQzVJ1d1jcnS7k9/bCq7/aBxxOcbb+Qovb+mezCwfV5L1nbvvDTmA0Ykqah6zLRtywPuwmCQ2BI4LB22AFTgYgSx9Yy8MeVnztVLxiwB+57aDJRXXtPcTU7gEgroA20XLxGMBrlHRqlhmCGhoBzc7GdspGZ69jp4OhuczzUQzjLT0js0i4doOGHNAI6poVrsSTtthhWe/qQU+gLZSBgLQJfobsUkFBAhzbpuqjXNTK3hcfDzViReT/GjvyXx4O+4C6fhNTollX0PDXGWl24PxGcXLDoDhl9t0TJKnXdO/B6kSWYxE9u/TAArLgTU7WFYZqtYW4BTUB2t7ysLa1Rbry7cWtw77LlZuIV1kfOcfIA8I7FhKOY2TwkPo1LLlkzsyGEdsNfbp2dUdVHgG1VBVIT8tej2rKVM+/vrte2L7naay7iAkANfJRfhDwsSkr+ggWjNkJPOZHJEdaRjtXgq7pmH4asRSH/rfq4buYH/VAiB0OiXCiwvVf6zTLjXh6n9Y=

language: cpp
matrix:
  include:
  - os: linux
    dist: bionic
    compiler: clang
    env:
    - CC=clang-8 CXX=clang++-8
    - DO_COVERAGE=true
  - os: linux
    dist: bionic
    env:
    - DO_COVERAGE=false
  - os: osx
    osx_image: xcode11
    env:
    - DO_COVERAGE=false
  - os: windows
    env:
    - DO_COVERAGE=false
before_install:
- echo $symbol_upload_key_password | gpg --passphrase-fd 0 .travis_sumbol_upload_key.json.gpg
- "$TRAVIS_BUILD_DIR/.travis/before-install-$TRAVIS_OS_NAME.sh"
before_script:
- "$TRAVIS_BUILD_DIR/.travis/before-script-$TRAVIS_OS_NAME.sh"
script:
- "$TRAVIS_BUILD_DIR/.travis/script-$TRAVIS_OS_NAME.sh"
before_deploy:
- "$TRAVIS_BUILD_DIR/.travis/before-deploy-$TRAVIS_OS_NAME.sh"
deploy:
- provider: s3
  access_key_id: "$AWS_KEY"
  secret_access_key: "$AWS_SECRET"
  bucket: scintillator-synth-coverage
  local-dir: "$HOME/artifacts"
  upload-dir: artifacts/$TRAVIS_COMMIT
  verbose: true
  edge: true
  cleanup: false
  acl: public_read
  on:
    condition: "$DO_COVERAGE = true"
    branch: master
- provider: s3
  access_key_id: "$AWS_KEY"
  secret_access_key: "$AWS_SECRET"
  bucket: scintillator-synth-coverage
  local-dir: "$HOME/builds"
  upload-dir: builds
  verbose: true
  edge: true
  cleanup: false
  acl: public_read
  on:
    condition: "$DO_COVERAGE = false"
    branch: master
- provider: s3
  access_key_id: "$AWS_KEY"
  secret_access_key: "$AWS_SECRET"
  bucket: scintillator-synth-coverage
  local-dir: "$HOME/releases"
  upload-dir: releases
  verbose: true
  edge: true
  cleanup: false
  acl: public_read
  on:
    tags: true
    condition: "$DO_COVERAGE = false"
    all_branches: true
- provider: gcs
  key_file: ".travis_symbol_upload_key.json"
  bucket: scintillator-gargamelle-symbols
  cleanup: false
  on:
    condition: "$DO_COVERAGE = false"
    branch: master

